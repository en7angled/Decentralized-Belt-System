---
description: Keeping docs and Swagger/API in sync when adding or changing features
globs: docs/**/*, src/exe/interaction-api/**/*, src/exe/query-api/**/*
alwaysApply: false
---
# Docs & API

## Generated from code (do not edit by hand)

- **`docs/bjj-belt-system-blueprint.json`**: Derived from on-chain code. Generated by `admin write-blueprint` (default output). Source: `Onchain.Blueprint` and types with `HasBlueprintDefinition`. When validators or protocol params change, update the blueprint module and run `admin write-blueprint` to regenerate.
- **`docs/swagger/`** (e.g. `query-swagger-api.json`, `interaction-swagger-api.json`): Derived from API code. Each API server writes its Swagger JSON on startup from the Servant API and `ToSchema` instances. To update: change routes/types, add `ToSchema` where needed, then run the corresponding API (query-api or interaction-api) to regenerate the file.

## Hand-maintained docs and API changes

- **Docs**: The cursor rules under `.cursor/rules/` are the canonical development reference; update them when patterns change. Cursor rules define process and checklists; `OnchainArchitecture.md` and `HaskellStyleGuide.md` are narrative/reference docsâ€”update both when patterns or code change. When validators or protocol params change, update OnchainArchitecture and regenerate the blueprint as above.
- **APIs**: Interaction API (8082): `/build-tx`, `/submit-tx`; Query API (8083): add new routes in RestAPI and handlers in Query.Projected / Query.Live. Use transfer types from `DomainTypes/Transfer/Types.hs` for responses (e.g. membership history + intervals). Add `ToSchema` for new types so Swagger stays in sync when the server runs.
- **Build vs submit:** Interaction API: `/build-tx` returns unsigned body; `/submit-tx` accepts body + witness and submits. See [executables.mdc](../architecture/executables.mdc) for provider and multi-address/collateral details.
